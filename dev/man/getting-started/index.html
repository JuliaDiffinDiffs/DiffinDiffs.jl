<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · DiffinDiffs.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://JuliaDiffinDiffs.github.io/DiffinDiffs.jl/stable/man/getting-started/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="DiffinDiffs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DiffinDiffs.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Dynamic-Effects-in-Event-Studies"><span>Dynamic Effects in Event Studies</span></a></li></ul></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/treatments/">Treatment Types</a></li><li><a class="tocitem" href="../../lib/parallels/">Parallel Types</a></li><li><a class="tocitem" href="../../lib/terms/">Formula Terms</a></li><li><a class="tocitem" href="../../lib/estimators/">Estimators</a></li><li><a class="tocitem" href="../../lib/inference/">Inference</a></li><li><a class="tocitem" href="../../lib/procedures/">Procedures</a></li><li><a class="tocitem" href="../../lib/results/">Results</a></li><li><a class="tocitem" href="../../lib/tables/">Tables</a></li><li><a class="tocitem" href="../../lib/panel/">Panel Operations</a></li><li><a class="tocitem" href="../../lib/ScaledArrays/">ScaledArrays</a></li><li><a class="tocitem" href="../../lib/StatsProcedures/">StatsProcedures</a></li><li><a class="tocitem" href="../../lib/miscellanea/">Miscellanea</a></li></ul></li><li><span class="tocitem">About</span><ul><li><a class="tocitem" href="../../about/references/">References</a></li><li><a class="tocitem" href="../../about/license/">License</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDiffinDiffs/DiffinDiffs.jl/blob/master/docs/src/man/getting-started.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><p>To demonstrate the basic usage of <a href="https://github.com/JuliaDiffinDiffs/DiffinDiffs.jl">DiffinDiffs.jl</a>, we walk through the processes of reproducing empirical results from relevant studies. Please refer to the original papers for details on the context.</p><h2 id="Dynamic-Effects-in-Event-Studies"><a class="docs-heading-anchor" href="#Dynamic-Effects-in-Event-Studies">Dynamic Effects in Event Studies</a><a id="Dynamic-Effects-in-Event-Studies-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamic-Effects-in-Event-Studies" title="Permalink"></a></h2><p>As a starting point, we reproduce results from the empirical illustration in <a href="../../about/references/#SunA21E">Liyang Sun, Sarah Abraham (2021)</a>.</p><h3 id="Data-Preparation"><a class="docs-heading-anchor" href="#Data-Preparation">Data Preparation</a><a id="Data-Preparation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Preparation" title="Permalink"></a></h3><p><a href="https://github.com/JuliaDiffinDiffs/DiffinDiffs.jl">DiffinDiffs.jl</a> requires that the data used for estimation are stored in a column table compatible with the interface defined in <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a>. This means that virtually all types of data frames, including <a href="https://github.com/JuliaData/DataFrames.jl">DataFrames.jl</a>, are supported. For the sake of illustration, here we directly load the dataset that is bundled with the package by calling <a href="../../lib/miscellanea/#DiffinDiffsBase.exampledata-Tuple{Union{String, Symbol}}"><code>exampledata</code></a>:</p><pre><code class="language-julia hljs">using DiffinDiffs
hrs = exampledata(&quot;hrs&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3280×11 VecColumnTable:
  Row │ hhidpn   wave  wave_hosp  oop_spend  riearnsemp  rwthh   male  spouse  ⋯
      │  Int64  Int64      Int64    Float64     Float64  Int64  Int64   Int64  ⋯
──────┼─────────────────────────────────────────────────────────────────────────
    1 │      1     10         10    6532.91   6.37159e5   4042      0       0  ⋯
    2 │      1      8         10    1326.93   3.67451e5   3975      0       0  ⋯
    3 │      1     11         10    1050.33     74130.5   3976      0       0  ⋯
    4 │      1      9         10    979.418     84757.4   3703      0       0  ⋯
    5 │      1      7         10    5498.68   1.66128e5   5295      0       0  ⋯
    6 │      2      8          8    41504.0         0.0   5187      0       1  ⋯
    7 │      2      7          8    3672.86         0.0   4186      0       1  ⋯
    8 │      2     10          8    1174.19         0.0   3729      0       1  ⋯
  ⋮   │   ⋮       ⋮        ⋮          ⋮          ⋮         ⋮      ⋮      ⋮     ⋱
 3273 │    655      8          9     1530.0     45000.0   8461      0       1  ⋯
 3274 │    655      9          9    7373.89     10359.2   9345      0       1  ⋯
 3275 │    655     10          9    673.568     38229.5   8420      0       1  ⋯
 3276 │    656     11          8    3020.78         0.0   1930      0       0  ⋯
 3277 │    656      8          8     2632.0         0.0   4810      0       0  ⋯
 3278 │    656      9          8     657.34         0.0   4768      0       0  ⋯
 3279 │    656     10          8    782.795         0.0   1909      0       0  ⋯
 3280 │    656      7          8    4182.39         0.0   4374      0       0  ⋯</code></pre><p>In this example, <code>hhidpn</code>, <code>wave</code>, and <code>wave_hosp</code> are columns for the unit IDs, time IDs and treatment time respectively. The rest of the columns contain the outcome variables and covariates. It is important that the time IDs and treatment time refer to each time period in a compatible way so that subtracting a value of treatment time from a value of calendar time (represented by a time ID) with operator <code>-</code> yields a meaningful value of relative time, the amount of time elapsed since treatment time.</p><h3 id="Empirical-Specifications"><a class="docs-heading-anchor" href="#Empirical-Specifications">Empirical Specifications</a><a id="Empirical-Specifications-1"></a><a class="docs-heading-anchor-permalink" href="#Empirical-Specifications" title="Permalink"></a></h3><p>To produce the estimates reported in panel (a) of Table 3 from <a href="../../about/references/#SunA21E">Liyang Sun, Sarah Abraham (2021)</a>, we specify the estimation via <a href="../../lib/results/#DiffinDiffsBase.@did-Tuple"><code>@did</code></a> as follows:</p><pre><code class="language-julia hljs">r = @did(Reg, data=hrs, dynamic(:wave, -1), notyettreated(11),
    vce=Vcov.cluster(:hhidpn), yterm=term(:oop_spend), treatname=:wave_hosp,
    treatintterms=(), xterms=(fe(:wave)+fe(:hhidpn)))</code></pre><p>Before we look at the results, we briefly explain some of the arguments that are relatively more important. <a href="../../lib/estimators/#InteractionWeightedDIDs.Reg"><code>Reg</code></a>, which is a shorthand for <a href="../../lib/estimators/#InteractionWeightedDIDs.RegressionBasedDID"><code>RegressionBasedDID</code></a>, is the type of the estimation to be conducted. Here, we need estimation that is conducted by directly solving least-squares regression and hence we use <a href="../../lib/estimators/#InteractionWeightedDIDs.Reg"><code>Reg</code></a> to inform <a href="../../lib/results/#DiffinDiffsBase.@did-Tuple"><code>@did</code></a> the relevant set of procedures, which also determines the set of arguments that are accepted by <a href="../../lib/results/#DiffinDiffsBase.@did-Tuple"><code>@did</code></a>.</p><p>We are interested in the dynamic treatment effects. Hence, we use <a href="../../lib/treatments/#DiffinDiffsBase.dynamic"><code>dynamic</code></a> to specify the data column containing values representing calendar time of the observations and the reference period, which is <code>-1</code>. For identification, a crucial assumption underlying DID is the parallel trends assumption. Here, we assume that the average outcome paths of units treated in periods before <code>11</code> would be parallel to the observed paths of units treated in period <code>11</code>. That is, we are taking units with treatment time <code>11</code> as the not-yet-treated control group. We specify <code>treatname</code> to be <code>:wave_hosp</code>, which indicates the column that contains the treatment time. The interpretation of <code>treatname</code> depends on the context that is jointly determined by the type of the estimator, the type of the treatment and possibly the type of parallel trends assumption. The rest of the arguments provide additional information on the regression specifications. The use of them can be found in the documentation for <a href="../../lib/estimators/#InteractionWeightedDIDs.RegressionBasedDID"><code>RegressionBasedDID</code></a>.</p><p>We now move on to the result returned by <a href="../../lib/results/#DiffinDiffsBase.@did-Tuple"><code>@did</code></a>:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">──────────────────────────────────────────────────────────────────────
Summary of results: Regression-based DID
──────────────────────────────────────────────────────────────────────
Number of obs:               2624    Degrees of freedom:            14
F-statistic:                 6.42    p-value:                   &lt;1e-07
──────────────────────────────────────────────────────────────────────
Cohort-interacted sharp dynamic specification
──────────────────────────────────────────────────────────────────────
Number of cohorts:              3    Interactions within cohorts:    0
Relative time periods:          5    Excluded periods:              -1
──────────────────────────────────────────────────────────────────────
Fixed effects: fe_hhidpn fe_wave
──────────────────────────────────────────────────────────────────────
Converged:                   true    Singletons dropped:             0
──────────────────────────────────────────────────────────────────────</code></pre><p>The object returned is of type <a href="../../lib/results/#InteractionWeightedDIDs.RegressionBasedDIDResult"><code>RegressionBasedDIDResult</code></a>, which contains the estimates for treatment-group-specific average treatment effects among other information. Instead of printing the estimates from the regression, which can be very long if there are many treatment groups, REPL prints a summary table for <code>r</code>. Here we verify that the estimate for relative time <code>0</code> among the cohort who received treatment in period <code>8</code> is about <code>2826</code>, the value reported in the third column of Table 3(a) in the paper.</p><pre><code class="language-julia hljs">coef(r, &quot;wave_hosp: 8 &amp; rel: 0&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2825.565911751418</code></pre><p>Various accessor methods are defined for retrieving values from a result such as <code>r</code>. See <a href="../../lib/results/#Results">Results</a> for a full list of them.</p><h3 id="Aggregation-of-Estimates"><a class="docs-heading-anchor" href="#Aggregation-of-Estimates">Aggregation of Estimates</a><a id="Aggregation-of-Estimates-1"></a><a class="docs-heading-anchor-permalink" href="#Aggregation-of-Estimates" title="Permalink"></a></h3><p>The treatment-group-specific estimates in <code>r</code> are typically not the ultimate objects of interest. We need to estimate the path of the average dynamic treatment effects across all treatment groups. Such estimates can be easily obtained by aggregating the estimates in <code>r</code> via <a href="../../lib/results/#DiffinDiffsBase.agg-Tuple{DIDResult}"><code>agg</code></a>:</p><pre><code class="language-julia hljs">a = agg(r, :rel)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">───────────────────────────────────────────────────────────────────
         Estimate  Std. Error     t  Pr(&gt;|t|)  Lower 95%  Upper 95%
───────────────────────────────────────────────────────────────────
rel: -3   591.046    1273.08   0.46    0.6425  -1905.3      3087.39
rel: -2   352.639     697.78   0.51    0.6133  -1015.62     1720.9
rel: 0   2960.04      540.989  5.47    &lt;1e-07   1899.23     4020.86
rel: 1    529.767     586.831  0.90    0.3667   -620.935    1680.47
rel: 2    800.106    1010.81   0.79    0.4287  -1181.97     2782.18
───────────────────────────────────────────────────────────────────</code></pre><p>Notice that <code>:rel</code> is a special value used to indicate that the aggregation is conducted for each value of relative time separately. The aggregation takes into account sample weights of each treatment group and the variance-covariance matrix. The resulting estimates match those reported in the second column of Table 3(a) exactly.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../lib/treatments/">Treatment Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 1 July 2022 16:46">Friday 1 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
